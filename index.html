<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Warframe Market Items</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: left;
    }
    th {
      background-color: #f4f4f4;
    }
  </style>
</head>
<body>
  <h1>Warframe Market Items</h1>
  <table id="itemsTable">
    <thead>
      <tr>
        <th>url_name</th>
        <th>item_name</th>
        <th>Calculated Field</th>
      </tr>
    </thead>
    <tbody>
      <!-- Items will be inserted here -->
    </tbody>
  </table>

  <script>
    // Fetch and render items from the Warframe Market API via AllOrigins proxy
    function fetchItems() {
      const apiUrl = 'https://api.warframe.market/v1/items';
      // AllOrigins requires the URL to be encoded
      const encodedUrl = encodeURIComponent(apiUrl);
      const proxyUrl = `https://api.allorigins.hexocode.repl.co/get?disableCache=true&url=${encodedUrl}`;

      fetch(proxyUrl)
        .then(response => {
          if (!response.ok) {
            throw new Error("Network response was not ok: " + response.statusText);
          }
          return response.json();
        })
        .then(data => {
          // AllOrigins returns the result in "contents" as a string.
          const contents = data.contents;
          // Parse the returned JSON string into an object.
          const parsedData = JSON.parse(contents);
          // Assuming the API returns an object with a payload containing an items array.
          const items = parsedData.payload.items;
          renderItems(items);
        })
        .catch(error => {
          console.error("Error fetching items:", error);
        });
    }

    // Render items in the table
    function renderItems(items) {
      const tableBody = document.getElementById("itemsTable").querySelector("tbody");
      tableBody.innerHTML = ""; // Clear any existing rows

      items.forEach(item => {
        const row = document.createElement("tr");

        // Create cell for url_name
        const urlNameCell = document.createElement("td");
        urlNameCell.textContent = item.url_name;
        row.appendChild(urlNameCell);

        // Create cell for item_name
        const itemNameCell = document.createElement("td");
        itemNameCell.textContent = item.item_name;
        row.appendChild(itemNameCell);

        // Placeholder cell for a future calculated field
        const calcFieldCell = document.createElement("td");
        calcFieldCell.textContent = "TBD";  // Replace with your calculated value later
        row.appendChild(calcFieldCell);

        tableBody.appendChild(row);
      });
    }

    // When the page loads, fetch the latest items
    window.onload = fetchItems;
  </script>
</body>
</html>
